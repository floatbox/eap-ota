#!/usr/bin/env ruby
require File.expand_path('../../config/environment',  __FILE__)

require 'readline'
prompt = ''
begin
  office = ( ARGV.shift || Amadeus::Session::BOOKING ).dup
  office.upcase!
  amadeus = Amadeus::Service.new(:book => true, :office => office)
  prompt = "#{Conf.amadeus.env} #{office} > "
  while !(command_line = Readline.readline(prompt, true)).nil?
    command_line.chomp!
    break if command_line == 'q'
    next if command_line == ''
    command_line.split(';').each do |cmd|
      puts amadeus.cmd(cmd)
    end
  end
ensure
  puts "logging out amadeus session ..."
  amadeus.session.destroy if amadeus
end
