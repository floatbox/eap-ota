Хот офферы создаются при любом новом поиске, независимо от их цены или времени до вылета.

  Единственное место, где может создаваться хот оффер - pricer_controller.create_hot_offer.
Он срабатывает, если: поиск валидный, есть рекоммендации, маршрут простой, нет детей,
пользователь не админ, выбран эконом класс и пункт отправления и прибытия это города.
В нем:
-в качестве рекомендации для hot_offer выбирается первая из массива @recommendations.
-вычисляется hot_offer.price, как цена с комиссией из этой первой рекомендации, поделенная на всех пассажиров.

  При создании hot_offer вызывается метод hot_offer.set_some_vars, который срабатывает, если есть @pricer_form и @recommendation
В нем:
-копируются данные из pricer_form (from, to, rt, date1, date2)
-вычисляется time_delta (количество дней от сегодня до вылета)
-ищется или создается(sic!) destination по трем полям: from_iata, to_iata, rt.
-вычисляется price_variation: разница текущей цены и средней цены по направлению
-вычисляется price_variation_percent: текущая цена делится на среднюю цену по направлению минус один, результат умножается на сто
-увеличивается счетчик хот офферов у destination, destination сохраняется.

---
Важно. Если destination создается, у него здесь же (hot_offer.set_some_vars) проставляются следующие значения:
-average_price, как сумма цен всех хот офферов по этому направлению, поделенная на их количество
-average_time_delta - то же самое, что и average_price, только вместо значения hot_offer.price берется hot_offer.time_delta

---
Еще важно.
Если destination нашелся, а не создается с нуля,
его average_price и average_time_delta заменяется значениями price и time_delta текущего создаваемого хот оффера.
---
В pricer_controller так же используется переменная @average_price,
которая вычисляется как средняя цена по направлению, умноженная на количество пассажиров.

---
Очевидный косяк.
Новый destination может также создаваться перед созданием хот оффера, так как перед вызовом метода create_hot_offer
отдельно вызывается find_or_create на Destination с текущими параметрами поиска.
Это косяк, потому что в hot_offer.set_some_vars тоже вызывается Destination.find_or_create,
а pricer_controller иногда использует результат своего поиска/создания (@destination), а иногда -
результат поиска/создания, происшедшего в рамках метода set_some_vars (hot_offer.destination).
